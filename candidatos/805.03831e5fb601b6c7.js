"use strict";(self.webpackChunkcandidatos=self.webpackChunkcandidatos||[]).push([[805],{1805:(w,l,r)=>{r.r(l),r.d(l,{PropuestasModule:()=>U});var p=r(6814),g=r(6208),c=r(95),m=r(5476),d=r(760),t=r(4769),h=r(553),P=r(9862);let f=(()=>{class s{constructor(e){this.http=e,this.apiUrl=h.N.apiUrl}getPropuestas(e){const o=this.apiUrl+"/api/propuesta/obtener_propuestas_id?id="+e.toString();return this.http.get(o)}getPropuestaId(e){const o=this.apiUrl+"/api/propuesta/obtener_propuesta_id?id="+e.toString();return this.http.get(o)}postPropuesta(e){return this.http.post(this.apiUrl+"/api/propuesta/agregar_propuesta",e)}putPropuesta(e,o){const a=this.apiUrl+"/api/propuesta/editar_propuesta_id?id="+e.toString();return this.http.put(a,o)}deletePropuesta(e){const o=this.apiUrl+"/api/propuesta/eliminar_propuesta_id?id="+e.toString();return this.http.delete(o)}}return s.\u0275fac=function(e){return new(e||s)(t.LFG(P.eN))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var v=r(8245),_=r(6207);function b(s,i){1&s&&(t.TgZ(0,"div",5),t._UZ(1,"div",6),t.qZA())}function x(s,i){if(1&s){const e=t.EpF();t.TgZ(0,"label",26)(1,"p"),t._uU(2," Agrega un foto de tu motivacion principal "),t.qZA(),t._UZ(3,"img",27),t.TgZ(4,"input",28),t.NdJ("change",function(a){t.CHM(e);const n=t.oxw(2);return t.KtG(n.seleccionarImagenPropuesta(a))}),t.qZA()()}}function C(s,i){if(1&s){const e=t.EpF();t.TgZ(0,"div",29),t._UZ(1,"img",30),t.TgZ(2,"button",31),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.eliminarFotoPropuesta())}),t._uU(3,"Eliminar Imagen"),t.qZA()()}if(2&s){const e=t.oxw(2);t.xp6(1),t.Q6J("src",e.imagenPropuesta.foto,t.LSH)}}function T(s,i){if(1&s){const e=t.EpF();t.TgZ(0,"div",32)(1,"div",33),t._UZ(2,"img",34),t.TgZ(3,"div",35)(4,"h5",36),t._uU(5),t.qZA(),t.TgZ(6,"p",37),t._uU(7),t.qZA(),t.TgZ(8,"button",38),t.NdJ("click",function(){const n=t.CHM(e).$implicit,u=t.oxw(2);return t.KtG(u.deletePropuesta(n.idPropuestaCompleta))}),t._uU(9,"Eliminar"),t.qZA(),t.TgZ(10,"button",39),t.NdJ("click",function(){const n=t.CHM(e).$implicit,u=t.oxw(2);return t.KtG(u.setFormularioPropuesta(n.idPropuestaCompleta))}),t._uU(11,"Editar"),t.qZA()()()()}if(2&s){const e=i.$implicit;t.xp6(2),t.Q6J("src",e.foto.foto,t.LSH),t.xp6(3),t.Oqu(e.titulo),t.xp6(2),t.hij("",e.descripcion.substring(0,90),"...")}}function A(s,i){if(1&s){const e=t.EpF();t.TgZ(0,"div")(1,"div",7)(2,"label",8),t._uU(3,"Propuestas del candidato"),t.qZA(),t.TgZ(4,"button",9),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.openModalPropuesta("staticBackdrop"))}),t._uU(5,"Agregar propuesta"),t.qZA()(),t.TgZ(6,"div",10)(7,"div",11)(8,"div",12)(9,"div",13)(10,"h1",14),t._uU(11,"Motivo"),t.qZA(),t.TgZ(12,"button",15),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.cerrarModal("staticBackdrop"))}),t.qZA()(),t.TgZ(13,"div",16)(14,"div",7)(15,"label",8),t._uU(16,"Foto del motivo principal "),t.qZA(),t.TgZ(17,"div",17),t.YNc(18,x,5,0,"label",18),t.qZA(),t.YNc(19,C,4,1,"div",19),t.qZA(),t.TgZ(20,"input",20),t.NdJ("ngModelChange",function(a){t.CHM(e);const n=t.oxw();return t.KtG(n.propuesta.titulo=a)}),t.qZA(),t.TgZ(21,"textarea",21),t.NdJ("ngModelChange",function(a){t.CHM(e);const n=t.oxw();return t.KtG(n.propuesta.descripcion=a)}),t.qZA()(),t.TgZ(22,"div",22)(23,"button",23),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.botonEditarPropuesta?a.putPropuesta():a.postPropuesta())}),t._uU(24),t.qZA()()()()(),t.TgZ(25,"div",24),t.YNc(26,T,12,3,"div",25),t.qZA()()}if(2&s){const e=t.oxw();t.xp6(18),t.Q6J("ngIf",e.imagenPropuesta&&""==e.imagenPropuesta.foto),t.xp6(1),t.Q6J("ngIf",e.imagenPropuesta&&""!=e.imagenPropuesta.foto),t.xp6(1),t.Q6J("ngModel",e.propuesta.titulo),t.xp6(1),t.Q6J("ngModel",e.propuesta.descripcion),t.xp6(3),t.hij(" ",e.botonEditarPropuesta?"Terminar de editar propuesta":"Terminar de agregar propuesta"," "),t.xp6(2),t.Q6J("ngForOf",e.propuestas)}}function Z(s,i){1&s&&t._UZ(0,"app-no-results")}const y=[{path:"",component:(()=>{class s{constructor(e,o){this.servicioPropuesta=e,this.servicioMensaje=o,this.idActual=localStorage.getItem("usuarioId"),this.isLoading=d.v.neutro,this.imagenPropuestaBase64="",this.imagenPropuesta={foto:"",tipo:1},this.botonEditarPropuesta=!1,this.propuesta={idPropuestaCompleta:0,idPropuesta:this.idActual,foto:{foto:"",tipo:1},titulo:"",descripcion:""},this.propuestas=[]}ngOnInit(){console.log("Inicializamos el compnente propuestas... "),this.getPropuestas()}getPropuestas(){this.isLoading=d.v.trueLoading,this.servicioPropuesta.getPropuestas(this.idActual).subscribe({next:e=>{console.log("TODO BIEN AL TRAER PRPOPUESTAS !!! "),this.propuestas=e,this.isLoading=d.v.falseLoading},error:e=>{this.isLoading=d.v.errorLoading}})}abrirModal(e){const o=document.getElementById(e);if(o){o.classList.add("show"),o.style.display="block",document.body.classList.add("modal-open");const a=document.createElement("div");a.classList.add("modal-backdrop","show"),document.body.appendChild(a)}}cerrarModal(e){const o=document.getElementById(e);if(o){o.classList.remove("show"),o.style.display="none",document.body.classList.remove("modal-open");const a=document.getElementsByClassName("modal-backdrop")[0];a&&document.body.removeChild(a)}}openModalPropuesta(e){this.propuesta={idPropuestaCompleta:0,idPropuesta:this.idActual,foto:{tipo:1,foto:""},titulo:"",descripcion:""},this.imagenPropuesta={tipo:1,foto:""},this.abrirModal(e),this.botonEditarPropuesta=!1}seleccionarImagenPropuesta(e){console.log("Obteniendo imagenes a editar... ");const o=e.target.files[0];if(o){const a=new FileReader;a.readAsDataURL(o),a.onload=()=>{this.imagenPropuestaBase64=a.result,this.imagenPropuesta={foto:this.imagenPropuestaBase64,tipo:2},console.log("La imagen actual del candidato --\x3e ",this.imagenPropuestaBase64)}}}eliminarFotoPropuesta(){console.log("Eliminamos la foto de la motivacion -> "),this.imagenPropuestaBase64="",this.imagenPropuesta={foto:"",tipo:1},console.log(this.imagenPropuesta)}postPropuesta(){this.propuesta.foto=this.imagenPropuesta,this.servicioPropuesta.postPropuesta(this.propuesta).subscribe({next:e=>{console.log("ENVIAMOS PROPUESTA !!! ",this.propuesta),this.propuestas.push(e),console.log(e),this.cerrarModal("staticBackdrop"),this.servicioMensaje.mensajeExito("Se agreg\xf3 con \xe9xito")},error:e=>{this.servicioMensaje.mensajeError("Error al agregar")}})}setFormularioPropuesta(e){this.botonEditarPropuesta=!0,this.abrirModal("staticBackdrop"),this.servicioPropuesta.getPropuestaId(e).subscribe({next:o=>{console.log("BIEN AL OBTENER LA PROPUESTA !!! "),this.propuesta=o,this.imagenPropuesta=o.foto},error:o=>{console.log("ERROR AL OBTENER LA PROPUESTA !!! ",o)}})}putPropuesta(){this.propuesta.foto=this.imagenPropuesta;const e=this.propuestas.findIndex(o=>o.idPropuestaCompleta==this.propuesta.idPropuestaCompleta);this.servicioPropuesta.putPropuesta(this.propuesta.idPropuestaCompleta,this.propuesta).subscribe({next:o=>{this.propuestas[e]=o,this.servicioMensaje.mensajeExito("Se actualiz\xf3 con \xe9xito"),this.cerrarModal("staticBackdrop")},error:o=>{this.servicioMensaje.mensajeError("Error al actualizar")}})}deletePropuesta(e){this.servicioMensaje.mensajeAdvertencia("\xbfEstas seguro de eliminar?",()=>{this.servicioPropuesta.deletePropuesta(e).subscribe({next:o=>{const a=this.propuestas.filter(n=>n.idPropuestaCompleta!=e);this.propuestas=a,this.servicioMensaje.mensajeExito("Se elimin\xf3 con \xe9xito")},error:o=>{this.servicioMensaje.mensajeExito("Error al eliminar")}})})}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(f),t.Y36(v.V))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-propuestas"]],decls:10,vars:4,consts:[[1,"row"],[1,"bienvenida"],[3,"ngSwitch"],["class","progress",4,"ngSwitchCase"],[4,"ngSwitchCase"],[1,"progress"],[1,"progress-bar","progress-bar-indeterminate","bg-green"],[1,"col-md-12"],["for","",1,"form-label"],[1,"btn","btn-primary",2,"width","100%",3,"click"],["id","staticBackdrop","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1","aria-labelledby","staticBackdropLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],["id","staticBackdropLabel",1,"modal-title","fs-3"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"form-group",2,"display","flex","justify-content","center","align-items","center"],["style","width: 100%; height: 100%; padding: 1rem; display: flex; flex-direction:column; align-items: center; border: 4px dashed rgb(225, 225, 225); border-radius: 5px;","for","imagen-propuesta",4,"ngIf"],["class","mt-1",4,"ngIf"],["type","text","name","titulo","placeholder","T\xedtulo de tu propuesta electoral...",1,"form-control","mt-3",3,"ngModel","ngModelChange"],["name","descripcion","id","","rows","10","placeholder","Describe detalladamente tu propuesta....",1,"form-control","mt-3",3,"ngModel","ngModelChange"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-success",2,"width","100%",3,"click"],[1,"container-lg","d-flex","flex-wrap","justify-content-between","mt-3",2,"padding","0"],["class","col-md-4 col-sm-6 col-12 px-1 mb-2",4,"ngFor","ngForOf"],["for","imagen-propuesta",2,"width","100%","height","100%","padding","1rem","display","flex","flex-direction","column","align-items","center","border","4px dashed rgb(225, 225, 225)","border-radius","5px"],["src","assets/images/galeria-de-fotos.png","alt","Subir imagen",2,"width","155px"],["type","file","accept","image/jpeg, image/png, image/gif","id","imagen-propuesta",1,"form-control",2,"display","none",3,"change"],[1,"mt-1"],["alt","",2,"width","100%",3,"src"],[1,"btn","btn-danger","mt-2",2,"width","100%",3,"click"],[1,"col-md-4","col-sm-6","col-12","px-1","mb-2"],[1,"card"],["alt","...",1,"card-img-top",3,"src"],[1,"card-body"],[1,"card-title"],[1,"card-text"],[1,"btn","btn-danger",2,"margin-right",".25rem",3,"click"],[1,"btn","btn-warning",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h1"),t._uU(3,"Bienvenida/o al cuestionario de propuestas del candidato"),t.qZA(),t.TgZ(4,"p"),t._uU(5,"Lee con atencion cada uno de los campos y verificalos antes de enviar"),t.qZA()()(),t.ynx(6,2),t.YNc(7,b,2,0,"div",3),t.YNc(8,A,27,6,"div",4),t.YNc(9,Z,1,0,"app-no-results",4),t.BQk()),2&e&&(t.xp6(6),t.Q6J("ngSwitch",o.isLoading),t.xp6(1),t.Q6J("ngSwitchCase",2),t.xp6(1),t.Q6J("ngSwitchCase",3),t.xp6(1),t.Q6J("ngSwitchCase",4))},dependencies:[p.sg,p.O5,p.RF,p.n9,_.S,c.Fj,c.JJ,c.On]}),s})(),canActivate:[r(2087).a],data:{claimType:"CanAccessPropuestas"}}];let S=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[m.Bz.forChild(y),m.Bz]}),s})(),U=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[p.ez,S,g.m,c.UX,c.u5]}),s})()}}]);