"use strict";(self.webpackChunkcandidatos=self.webpackChunkcandidatos||[]).push([[342],{3342:(V,_,u)=>{u.r(_),u.d(_,{UsuariosModule:()=>K});var d=u(6814),h=u(5476),a=u(95),l=u(760),e=u(4769),f=u(6223),b=u(8245),x=u(8672),Z=u(6207),g=u(9317),p=u(6472);const A=["closebutton"];function C(r,s){1&r&&(e.TgZ(0,"div",43),e._UZ(1,"div",44),e.qZA())}function D(r,s){1&r&&(e.ynx(0),e._UZ(1,"span",65),e._uU(2,"Activo "),e.BQk())}function T(r,s){1&r&&(e._UZ(0,"span",66),e._uU(1," Inactivo "))}function F(r,s){if(1&r){const o=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e.YNc(10,D,3,0,"ng-container",58),e.YNc(11,T,2,0,"ng-template",null,59,e.W1O),e.qZA(),e.TgZ(13,"td")(14,"div",60)(15,"button",61),e.NdJ("click",function(){const n=e.CHM(o).$implicit,c=e.oxw(2);return e.KtG(c.setDataModalUpdateD(n.idUsuario))}),e._UZ(16,"i",62),e.qZA(),e.TgZ(17,"button",63),e.NdJ("click",function(){const n=e.CHM(o).$implicit,c=e.oxw(2);return e.KtG(c.borrarUsuarioD(n.idUsuario,n.nombre))}),e._UZ(18,"i",64),e.qZA()()()()}if(2&r){const o=s.$implicit,t=e.MAs(12);e.xp6(2),e.Oqu(o.idUsuario),e.xp6(2),e.Oqu(o.nombre),e.xp6(2),e.Oqu(o.rol),e.xp6(2),e.Oqu(o.email),e.xp6(2),e.Q6J("ngIf",o.estatus)("ngIfElse",t)}}function q(r,s){if(1&r&&(e.TgZ(0,"option",67),e._uU(1),e.qZA()),2&r){const o=s.$implicit;e.Q6J("value",o),e.xp6(1),e.hij(" ",o," ")}}const E=function(r,s){return{itemsPerPage:r,currentPage:s}};function S(r,s){if(1&r){const o=e.EpF();e.TgZ(0,"div")(1,"div",45)(2,"table",46)(3,"thead")(4,"tr")(5,"th",47),e._uU(6,"#"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Nombre"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Rol"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Correo"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Estatus"),e.qZA(),e.TgZ(15,"th",48),e._uU(16,"Acciones"),e.qZA()()(),e.TgZ(17,"tbody",49),e._UZ(18,"tr"),e.YNc(19,F,19,6,"tr",50),e.ALo(20,"paginate"),e.qZA()()(),e.TgZ(21,"div",51)(22,"div",52)(23,"label",53),e._uU(24,"Elementos por p\xe1gina:"),e.qZA(),e.TgZ(25,"select",54),e.NdJ("ngModelChange",function(i){e.CHM(o);const n=e.oxw();return e.KtG(n.itemsPerPage=i)}),e.YNc(26,q,2,2,"option",55),e.qZA()(),e.TgZ(27,"div",56)(28,"pagination-controls",57),e.NdJ("pageChange",function(i){e.CHM(o);const n=e.oxw();return e.KtG(n.currentPage=i)}),e.qZA()()()()}if(2&r){const o=e.oxw();e.xp6(19),e.Q6J("ngForOf",e.xi3(20,3,o.usuariosD,e.WLB(6,E,o.itemsPerPage,o.currentPage))),e.xp6(6),e.Q6J("ngModel",o.itemsPerPage),e.xp6(1),e.Q6J("ngForOf",o.itemsPerPageOptions)}}function I(r,s){1&r&&e._UZ(0,"app-no-results")}function j(r,s){1&r&&(e.TgZ(0,"div"),e._uU(1," El nombre es obligatorio "),e.qZA())}function M(r,s){if(1&r&&(e.TgZ(0,"div",68),e.YNc(1,j,2,0,"div",69),e.qZA()),2&r){const o=e.oxw();let t;e.xp6(1),e.Q6J("ngIf",null==(t=o.userFormD.get("nombre"))?null:t.hasError("required"))}}function L(r,s){1&r&&(e.TgZ(0,"div"),e._uU(1," El correo electr\xf3nico es requerido "),e.qZA())}function J(r,s){1&r&&(e.TgZ(0,"div"),e._uU(1," Ingresa una direcci\xf3n de correo electr\xf3nico v\xe1lida "),e.qZA())}function P(r,s){if(1&r&&(e.TgZ(0,"div",68),e.YNc(1,L,2,0,"div",69),e.YNc(2,J,2,0,"div",69),e.qZA()),2&r){const o=e.oxw();let t,i;e.xp6(1),e.Q6J("ngIf",null==(t=o.userFormD.get("email"))?null:t.hasError("required")),e.xp6(1),e.Q6J("ngIf",null==(i=o.userFormD.get("email"))?null:i.hasError("email"))}}function w(r,s){1&r&&(e.TgZ(0,"div"),e._uU(1," La contrase\xf1a es requerida "),e.qZA())}function O(r,s){1&r&&(e.TgZ(0,"div"),e._uU(1," La contrase\xf1a debe tener al menos 8 caracteres "),e.qZA())}function N(r,s){1&r&&(e.TgZ(0,"div"),e._uU(1," La contrase\xf1a debe contener al menos una letra may\xfascula y un n\xfamero "),e.qZA())}function y(r,s){if(1&r&&(e.TgZ(0,"div",68),e.YNc(1,w,2,0,"div",69),e.YNc(2,O,2,0,"div",69),e.YNc(3,N,2,0,"div",69),e.qZA()),2&r){const o=e.oxw();let t,i,n;e.xp6(1),e.Q6J("ngIf",null==(t=o.userForm.get("password"))?null:t.hasError("required")),e.xp6(1),e.Q6J("ngIf",null==(i=o.userForm.get("password"))?null:i.hasError("minlength")),e.xp6(1),e.Q6J("ngIf",null==(n=o.userForm.get("password"))?null:n.hasError("pattern"))}}function R(r,s){1&r&&e._uU(0),2&r&&e.hij(" ",s.item.rol1," ")}function Q(r,s){1&r&&(e.TgZ(0,"div"),e._uU(1," El rol es requerido "),e.qZA())}function k(r,s){if(1&r&&(e.TgZ(0,"div",68),e.YNc(1,Q,2,0,"div",69),e.qZA()),2&r){const o=e.oxw();let t;e.xp6(1),e.Q6J("ngIf",null==(t=o.userFormD.get("rolId"))?null:t.hasError("required"))}}const Y=function(r,s){return{"text-success":r,"text-danger":s}},G=[{path:"",component:(()=>{class r{pageChanged(o){this.currentPage=o}constructor(o,t,i,n){this.usuarioService=o,this.mensajeService=t,this.spinnerService=i,this.formBuilder=n,this.usuarios=[],this.isLoadingUsers=l.v.neutro,this.usuariosFilter=[],this.filtro="",this.roles=[],this.isModalAdd=!1,this.itemsPerPage=10,this.currentPage=1,this.itemsPerPageOptions=[5,10,15],this.usuariosD=[],this.rolesD=[],this.isLoadingUsersD=l.v.neutro,this.crearFormularioUsuario(),this.crearFormularioD()}ngOnInit(){this.usuarioService.refreshLisUsersD.subscribe(()=>{this.getListadoUsuariosD()}),this.getListadoUsuariosD(),this.getRolesD()}crearFormularioUsuario(){this.userForm=this.formBuilder.group({usuarioId:[null],rolId:[null,a.kI.required],email:["",[a.kI.required,a.kI.email]],password:["",[a.kI.required,a.kI.minLength(8),a.kI.pattern(/[A-Z]/),a.kI.pattern(/[0-9]/)]],nombre:["",a.kI.required],apellidos:["",a.kI.required],estatus:[!0]})}crearFormularioD(){this.userFormD=this.formBuilder.group({idUsuario:[null],idRol:[null,a.kI.required],email:["",[a.kI.required,a.kI.email]],passwordUsuario:["",[a.kI.required,a.kI.minLength(8),a.kI.pattern(/[A-Z]/),a.kI.pattern(/[0-9]/)]],nombre:["",a.kI.required],estatus:[!0]})}getListadoUsuarios(){this.usuarioService.getUsuarios().subscribe({next:o=>{this.usuarios=o.filter(t=>{const n=["administrador","gestor"].includes(t.rol.toLowerCase());return n||console.warn(`Usuario con rol no v\xe1lido: ${t.rol}`),n}),console.log("Usuarios despu\xe9s del filtrado:",this.usuarios),this.isLoadingUsers=l.v.falseLoading},error:o=>{this.isLoadingUsers=l.v.errorLoading,console.error("Error al obtener usuarios:",o)}})}getListadoUsuariosD(){this.isLoadingUsersD=l.v.trueLoading,console.log("EL ESTADO DE LA BARRA DE PROGRESO...",this.isLoadingUsersD),this.usuarioService.getUsuariosD().subscribe({next:o=>{this.usuariosD=o,console.log(this.usuariosD),this.isLoadingUsersD=l.v.falseLoading,console.log("EL ESTADO DE LA BARRA DE PROGRESO...",this.isLoadingUsersD)},error:()=>{this.isLoadingUsersD=l.v.errorLoading}})}getUsersSearch(o){let t=o.target.value;console.log("Esta es la busqueda --\x3e ",t),""!==t?this.usuarioService.getUsuariosFiltro(t).subscribe({next:i=>{console.log("Los usuarios filtrados --- > ",i),this.usuariosD=i},error:i=>{console.log(i)}}):this.getListadoUsuariosD()}getRoles(){this.usuarioService.getRoles().subscribe({next:o=>{this.roles=o.filter(t=>"Candidato"!==t.nombre)},error:o=>{console.log("Error al obtener los roles",o)}})}getRolesD(){this.usuarioService.getRolesD().subscribe({next:o=>{this.rolesD=o,console.log(this.rolesD)},error:o=>{console.log("error al obtener los roles",o)}})}resetForm(){this.closebutton.nativeElement.click(),this.userForm.reset()}resetFormD(){this.closebutton.nativeElement.click(),this.userFormD.reset()}agregarUsuario(){this.usuarioService.postUsuario(this.usuario).subscribe({next:()=>{this.mensajeService.mensajeExito("Usuario agregado con \xe9xito"),this.resetForm()},error:o=>{this.mensajeService.mensajeError("Error al agregar usuario"),console.error(o)}})}agregarUsuarioD(){console.log("Aca enviamos el formulario para agregar --- > ",this.usuarioD),this.usuarioService.postUsuarioD(this.usuarioD).subscribe({next:()=>{this.mensajeService.mensajeExito("Usuario agregado con \xe9xito"),this.resetFormD()},error:o=>{this.mensajeService.mensajeError("Error al agregar usuario"),console.error(o)}})}actualizarUsuario(){this.usuarioService.putUsuario(this.usuario).subscribe({next:()=>{this.mensajeService.mensajeExito("Usuario actualizado con \xe9xito"),this.resetForm()},error:o=>{this.mensajeService.mensajeError("Error al actualizar usuario"),console.error(o)}})}actualizarUsuarioD(){this.usuarioService.putUsuarioD(this.usuarioD.idUsuario,this.usuarioD).subscribe({next:()=>{this.mensajeService.mensajeExito("Usuario actualizado con \xe9xito"),this.resetFormD()},error:o=>{this.mensajeService.mensajeError("Error al actualizar usuario"),console.error(o)}})}submitUsuario(){this.usuario=this.userForm.value,this.isModalAdd?this.agregarUsuario():this.actualizarUsuario()}submitUsuarioD(){this.usuarioD=this.userFormD.value,this.isModalAdd?this.agregarUsuarioD():this.actualizarUsuarioD()}borrarUsuario(o,t){this.mensajeService.mensajeAdvertencia(`\xbfEst\xe1s seguro de eliminar el usuario: ${t}?`,()=>{this.usuarioService.deleteUsuario(o).subscribe({next:()=>{this.mensajeService.mensajeExito("Usuario borrado correctamente")},error:i=>this.mensajeService.mensajeError(i)})})}borrarUsuarioD(o,t){this.mensajeService.mensajeAdvertencia(`\xbfEst\xe1s seguro de eliminar el usuario: ${t}?`,()=>{this.usuarioService.deleteUsuarioD(o).subscribe({next:()=>{this.mensajeService.mensajeExito("Usuario borrado correctamente")},error:i=>this.mensajeService.mensajeError(i)})})}handleChangeAdd(){this.userForm.reset(),this.isModalAdd=!0}handleChangeAddD(){this.userFormD.reset(),this.isModalAdd=!0}setDataModalUpdate(o){this.isModalAdd=!1,this.userForm.patchValue({idUsuario:o.idUsuario,rolId:o.idRol,email:o.email,password:o.passwordUsuario,estatus:o.estatus,nombre:o.nombre,apellidos:"--- > "}),console.log(this.userForm.value)}setDataModalUpdateD(o){this.isModalAdd=!1,this.usuarioService.getUsuarioId(o).subscribe({next:t=>{console.log("DATOS DEL USUARIO -- > ",t),this.userFormD.patchValue({idUsuario:t.idUsuario,idRol:t.idRol,email:t.email,passwordUsuario:t.passwordUsuario,estatus:t.estatus,nombre:t.nombre})},error:t=>{this.mensajeService.mensajeError(t)}}),console.log("Los datos del usuaio --- > ",o)}}return r.\u0275fac=function(o){return new(o||r)(e.Y36(f.i),e.Y36(b.V),e.Y36(x.t2),e.Y36(a.qu))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-usuarios"]],viewQuery:function(o,t){if(1&o&&e.Gf(A,5),2&o){let i;e.iGM(i=e.CRH())&&(t.closebutton=i.first)}},decls:69,vars:20,consts:[[1,"row","row-cards"],[1,"col-12"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body","border-bottom","py-3"],[1,"d-flex"],["data-bs-toggle","modal","data-bs-target","#modal-report",1,"btn","btn-primary",3,"click"],[1,"ti","ti-plus","me-1"],[1,"ms-auto","text-muted"],[1,"input-icon"],["type","text","value","","placeholder","Buscar",1,"form-control","form-control-rounded",3,"input"],[1,"input-icon-addon"],[1,"ti","ti-search"],[3,"ngSwitch"],["class","progress",4,"ngSwitchCase"],[4,"ngSwitchCase"],["id","modal-report","tabindex","-1","role","dialog","aria-hidden","true",1,"modal","modal-blur","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],["closebutton",""],[3,"formGroup","ngSubmit"],[1,"modal-body"],[1,"row"],[1,"col-lg-12"],[1,"mb-3"],[1,"form-label"],["type","text","formControlName","nombre",1,"form-control"],["class","error-message",4,"ngIf"],[1,"col-lg-6"],["type","text","formControlName","email",1,"form-control"],["type","password","formControlName","passwordUsuario",1,"form-control"],["placeholder","Elegir","bindLabel","rol1","bindValue","idRol","formControlName","idRol",3,"items","searchable","clearable"],["ng-option-tmp",""],["for","estadoActivo",1,"form-label"],[1,"form-check","form-switch","checkbox-verde"],["type","checkbox","formControlName","estatus",1,"form-check-input"],[1,"form-check-label",3,"ngClass"],[1,"modal-footer"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"progress"],[1,"progress-bar","progress-bar-indeterminate","bg-green"],[1,"table-responsive"],[1,"table","card-table","table-vcenter","text-nowrap","datatable"],[1,"w-1"],[1,"text-center",2,"width","7%"],[1,"table-tbody"],[4,"ngFor","ngForOf"],[1,"pagination-and-items-per-page",2,"margin-bottom","0px"],[1,"items-per-page"],["for","itemsPerPage"],["id","itemsPerPage",2,"margin-left","5px",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"pagination-container"],[3,"pageChange"],[4,"ngIf","ngIfElse"],["elseEST",""],[1,"d-flex","justify-content-between"],["data-bs-toggle","modal","data-bs-target","#modal-report",1,"btn","btn-warning","btn-icon","btn-sm",3,"click"],[1,"ti","ti-edit"],[1,"btn","btn-danger","btn-icon","btn-sm",3,"click"],[1,"ti","ti-eraser"],[1,"badge","bg-success","me-1"],[1,"badge","bg-danger","me-1"],[3,"value"],[1,"error-message"],[4,"ngIf"]],template:function(o,t){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),e._uU(5,"Usuarios"),e.qZA()(),e.TgZ(6,"div",5)(7,"div",6)(8,"button",7),e.NdJ("click",function(){return t.handleChangeAddD()}),e._UZ(9,"i",8),e._uU(10,"Agregar Usuario "),e.qZA(),e.TgZ(11,"div",9)(12,"div",10)(13,"input",11),e.NdJ("input",function(n){return t.getUsersSearch(n)}),e.qZA(),e.TgZ(14,"span",12),e._UZ(15,"i",13),e.qZA()()()()(),e.ynx(16,14),e.YNc(17,C,2,0,"div",15),e.YNc(18,S,29,9,"div",16),e.YNc(19,I,1,0,"app-no-results",16),e.BQk(),e.qZA()(),e.TgZ(20,"div",17)(21,"div",18)(22,"div",19)(23,"div",20)(24,"h5",21),e._uU(25),e.qZA(),e._UZ(26,"button",22,23),e.qZA(),e.TgZ(28,"form",24),e.NdJ("ngSubmit",function(){return t.submitUsuarioD()}),e.TgZ(29,"div",25)(30,"div",26)(31,"div",27)(32,"div",28)(33,"label",29),e._uU(34,"Nombre Completo"),e.qZA(),e._UZ(35,"input",30),e.YNc(36,M,2,1,"div",31),e.qZA()()(),e.TgZ(37,"div",26)(38,"div",32)(39,"div",28)(40,"label",29),e._uU(41,"Correo Electr\xf3nico"),e.qZA(),e._UZ(42,"input",33),e.YNc(43,P,3,2,"div",31),e.qZA()(),e.TgZ(44,"div",32)(45,"div",28)(46,"label",29),e._uU(47,"Contrase\xf1a"),e.qZA(),e._UZ(48,"input",34),e.YNc(49,y,4,3,"div",31),e.qZA()()(),e.TgZ(50,"div",26)(51,"div",32)(52,"div",28)(53,"label",29),e._uU(54,"Rol"),e.qZA(),e.TgZ(55,"ng-select",35),e.YNc(56,R,1,1,"ng-template",36),e.qZA(),e.YNc(57,k,2,1,"div",31),e.qZA()(),e.TgZ(58,"div",32)(59,"div",28)(60,"label",37),e._uU(61,"Estatus"),e.qZA(),e.TgZ(62,"label",38),e._UZ(63,"input",39),e.TgZ(64,"span",40),e._uU(65),e.qZA()()()()()(),e.TgZ(66,"div",41)(67,"button",42),e._uU(68),e.qZA()()()()()()()),2&o){let i,n,c,v,m,U;e.xp6(16),e.Q6J("ngSwitch",t.isLoadingUsersD),e.xp6(1),e.Q6J("ngSwitchCase",2),e.xp6(1),e.Q6J("ngSwitchCase",3),e.xp6(1),e.Q6J("ngSwitchCase",4),e.xp6(6),e.hij(" ",t.isModalAdd?"Agregar":"Actualizar"," Usuario "),e.xp6(3),e.Q6J("formGroup",t.userFormD),e.xp6(8),e.Q6J("ngIf",null==(i=t.userFormD.get("nombre"))?null:i.touched),e.xp6(7),e.Q6J("ngIf",null==(n=t.userFormD.get("email"))?null:n.touched),e.xp6(6),e.Q6J("ngIf",null==(c=t.userForm.get("password"))?null:c.touched),e.xp6(6),e.Q6J("items",t.rolesD)("searchable",!1)("clearable",!1),e.xp6(2),e.Q6J("ngIf",null==(v=t.userFormD.get("rolId"))?null:v.touched),e.xp6(7),e.Q6J("ngClass",e.WLB(17,Y,!0===(null==(m=t.userFormD.get("estatus"))?null:m.value),!1===(null==(m=t.userFormD.get("estatus"))?null:m.value))),e.xp6(1),e.hij(" ",null!=(U=t.userFormD.get("estatus"))&&U.value?"Activo":"Inactivo"," "),e.xp6(2),e.Q6J("disabled",!t.userFormD.valid),e.xp6(1),e.hij(" ",t.isModalAdd?"Agregar":"Actualizar"," ")}},dependencies:[d.mk,d.sg,d.O5,d.RF,d.n9,Z.S,a._Y,a.YN,a.Kr,a.Fj,a.Wl,a.EJ,a.JJ,a.JL,a.sg,a.u,a.On,g.w9,g.ir,p.LS,p._s],styles:[".pagination-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:20px;margin-bottom:5px}.pagination-and-items-per-page[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding:10px;background-color:#f0f0f0;border-radius:5px;box-shadow:0 2px 4px #0000001a}.items-per-page[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:14px;padding:5px;border:1px solid #ccc;border-radius:3px}textarea[_ngcontent-%COMP%]{resize:none}.input-group[_ngcontent-%COMP%]{position:relative;border-radius:10px}.input-group[_ngcontent-%COMP%]   .ti-search[_ngcontent-%COMP%]{color:#000;position:absolute;right:10px;top:10%;transform:translate(-150%)}.error-message[_ngcontent-%COMP%]{color:red}.modal-dialog[_ngcontent-%COMP%]{max-width:90%}h3[_ngcontent-%COMP%]{text-align:center}h4[_ngcontent-%COMP%]{text-align:right;color:red}h2[_ngcontent-%COMP%]{text-align:center}"]}),r})(),canActivate:[u(2087).a],data:{claimType:"CanAccessUsuarios"}}];let $=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[h.Bz.forChild(G),h.Bz]}),r})();var H=u(6208);let K=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[d.ez,$,H.m,a.UX,a.u5,g.A0,p.JX]}),r})()}}]);